Cours 6

Exercice 1 :
SELECT nom, prénom FROM personne;
SELECT titre, genre, durée FROM film WHERE durée <= 120;
SELECT titre, genre, durée FROM film WHERE année BETWEEN 1970 AND 1980;
SELECT nom FROM pays WHERE continent IN ("Europe", "Amérique");
SELECT prénom, nom, date_naissance FROM personne WHERE date_décès IS NULL;


Exercice 2 :
SELECT titre, année FROM film ORDER BY année DESC;
SELECT titre, année FROM film WHERE genre = "Drame" ORDER BY durée;
SELECT max(année) FROM film WHERE genre = "Western";
SELECT titre, min(durée) FROM film WHERE genre = "Science-fiction";
SELECT sum(durée)/60 FROM film;


Exercice 3 :
SELECT sum(durée)/60 AS durée_totale FROM film;
SELECT count(id) AS nombre, action AS rôle FROM role GROUP BY action;
SELECT genre, avg(durée), count(id) FROM film GROUP BY genre;
SELECT prénom, count(id) AS nombre FROM personne GROUP BY prénom ORDER BY nombre DESC;
SELECT année, avg(durée) AS durée_moyenne FROM film GROUP BY année ORDER BY durée_moyenne;


Exercice 4 :
SELECT prénom, count(id) AS nombre FROM personne GROUP BY prénom HAVING nombre > 1;
SELECT genre, avg(durée) AS durée_moyenne, count(id) AS nombre_films FROM film GROUP BY genre HAVING durée_moyenne < 120;
SELECT genre, avg(durée) AS durée_moyenne, count(id) AS nombre_films FROM film WHERE année > 1980 GROUP BY genre HAVING durée_moyenne > 120;

Exercice 5 :
SELECT titre FROM film ORDER BY durée DESC LIMIT 3;
SELECT substr(nom, 1, 3) AS init FROM ville;
SELECT prénom, nom, 1900 + substr(date_naissance, 7, 2) FROM personne WHERE date_décès IS NOT NULL;

